var Tetris=function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){e.exports=r(1)},function(e,t,r){r(2),r(3);const n=r(4);e.exports=n.app},function(e,t,r){},function(e,t,r){},function(e,t,r){"use strict";r.r(t);var n={};r.r(n),r.d(n,"files",function(){return c}),r.d(n,"ranks",function(){return a}),r.d(n,"allKeys",function(){return s}),r.d(n,"pos2key",function(){return d}),r.d(n,"key2pos",function(){return l}),r.d(n,"black",function(){return f}),r.d(n,"white",function(){return p}),r.d(n,"readFen",function(){return y}),r.d(n,"fPosToTranslateAbs",function(){return g});var o={};r.r(o),r.d(o,"tag",function(){return k}),r.d(o,"div",function(){return m}),r.d(o,"updateChildren",function(){return w}),r.d(o,"fTranslateAbs",function(){return v});var i={};r.r(i),r.d(i,"svg",function(){return C}),r.d(i,"renderShape",function(){return x}),r.d(i,"renderMarker",function(){return E});const u={key:"g",color:"#15781B",opacity:1,lineWidth:10},c=["a","b","c","d","e","f","g","h"],a=["1","2","3,","4","5","6","7","8"],s=Array.prototype.concat(...c.map(e=>a.map(t=>e+t))),d=e=>s[8*e[0]+e[1]],l=e=>[e.charCodeAt(0)-97,e.charCodeAt(1)-49],f="black",p="white";let h={w:p,b:f},b={k:"king",q:"queen",r:"rook",b:"bishop",n:"knight",p:"pawn"};function y({fen:e,shapes:t}){let[r,n,o,i]=e.split(" "),c=h[n],a=r.split("/").flatMap((e,t)=>{t=7-t;let r=[],n=0;for(let o of e){let e,i;(e=b[o])?i=f:(e=b[o.toLowerCase()])&&(i=p),i?(r.push({pos:[n,t],key:d([n,t]),role:e,color:i}),n++):n+=parseInt(o)}return r}),s=t.split(" ");return{pieces:a,color:c,shapes:t=s.map(e=>{let[t,r]=e.split("-");return{orig:(e=>e)(t),dest:(e=>e)(r),brush:u}})}}const g=e=>{const t=e.width/8,r=e.height/8;return(e,n)=>((e,t,r,n)=>[(t?e[0]:7-e[0])*r,(t?7-e[1]:e[1])*n])(e,n,t,r)};function k(e,t=[],r){let[n,...o]=e.split("."),i=document.createElement(n);return o.forEach(e=>{i.classList.add(e)}),t.forEach?t.forEach(e=>{i.appendChild(e)}):i.append(t),r&&r(i),i}const m=(e,t)=>k("div"+e,t),w=(e,t)=>{for(e=e.firstChild;e;)t(e),e=e.nextSibling},v=e=>t=>{t.style.transform=`translate(${e[0]}px,${e[1]}px)`};function C(e,t=[]){let r=document.createElementNS("http://www.w3.org/2000/svg",e);return t.forEach&&t.forEach(e=>r.appendChild(e)),r}function x(e,t,r){let n,o=A(l(e.orig),t);if(e.dest){let i=A(l(e.dest),t);n=function(e,t,r,n){const o=function(e){return 10/512*e.width}(n),i=M(t,n),u=M(r,n),c=u[0]-i[0],a=u[1]-i[1],s=Math.atan2(a,c),d=Math.cos(s)*o,l=Math.sin(s)*o;return T(C("line"),{stroke:e.color,"stroke-width":S(e,n),"stroke-linecap":"round","marker-end":"url(#arrowhead-"+e.key+")",opacity:e.opacity,x1:i[0],y1:i[1],x2:u[0]-d,y2:u[1]-l})}(e.brush,o,i,r)}else n=function(e,t,r){const n=M(t,r),o=function(e){return e.width/512*4}(r),i=(r.width+r.height)/32;return T(C("circle"),{stroke:e.color,"stroke-width":o,fill:"none",opacity:e.opacity,cx:n[0],cy:n[1],r:i-o/2})}(e.brush,o,r);return n}function S(e,t){return(e.lineWidth||10)/512*t.width}function M(e,t){return[(e[0]+.5)*t.width/8,(7.5-e[1])*t.height/8]}function A(e,t){return"white"===t?e:[7-e[0],7-e[1]]}function E(e){const t=T(C("marker"),{id:"arrowhead-"+e.key,orient:"auto",markerWidth:4,markerHeight:8,refX:2.05,refY:2.01});return t.appendChild(T(C("path"),{d:"M0,0 V4 L3,2 Z",fill:e.color})),t.setAttribute("mdKey",e.key),t}function T(e,t){for(const r in t)e.setAttribute(r,t[r]);return e}let{ranks:O,files:j,key2pos:P,fPosToTranslateAbs:_}=n,{svg:B,renderMarker:K,renderShape:R}=i,{div:$,tag:q,fTranslateAbs:L,updateChildren:W}=o;function z(e){e.querySelectorAll("[data-fen]").forEach(e=>{let t=y({fen:e.dataset.fen,shapes:e.dataset.shapes}),r=function(e,t){let{color:r,pieces:n,shapes:o}=t,i=e.getBoundingClientRect(),c=_(i),a=q("md-board",n.map(e=>{let t=q(`piece.${e.color}.${e.role}`,[],L(c(e.pos)));return t.mdKey=e.key,t})),s=B("svg",[B("defs",[K(u)]),...o.map(e=>R(e,r,i))]),d=q("md-wrap",[a,s,q("coords.ranks."+r,O.map(e=>q("coord",e))),q("coords.files."+r,j.map(e=>q("coord",e)))]);return e.appendChild(d),{board:a,svg:s}}(e,t);!function(e,t){new window.ResizeObserver(t).observe(e)}(e,()=>{!function(e,t){let{color:r}=t,{board:n}=e,o="white"===r,i=n.getBoundingClientRect(),u=_(i);W(n,e=>{L(u(P(e.mdKey)),o)(e)})}(r,t),function(e,t){let{shapes:r,color:n}=t,{board:o,svg:i}=e,u=o.getBoundingClientRect(),c=i.firstChild,a=[];for(c=c.nextSibling;c;)a.push(c),c=c.nextSibling;for(const e of a)i.removeChild(e);r.forEach(e=>{i.appendChild(R(e,n,u))})}(r,t)})})}function F(e,t){z(e)}r.d(t,"app",function(){return F})}]);